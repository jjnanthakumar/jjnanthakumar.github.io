var conditionalColors={PRESENT:"blue",COMPLETED:"green"};function LoadExcelJSON(data){let workbook=XLSX.read(data,{type:"base64"}),collections={certifications:[],experience:[],skills:[],projects:[]},sheet_name_list;workbook.SheetNames.forEach((function(y){let roa=XLSX.utils.sheet_to_json(workbook.Sheets[y]);roa.length>0&&("Certifications"==y?collections.certifications.push(roa):"Experience"==y?collections.experience.push(roa):"Skills"==y?collections.skills.push(roa):"Projects"==y&&collections.projects.push(roa))})),localStorage.setItem("collections",JSON.stringify(collections))}function GetLocalData(){let stored=localStorage.getItem("collections");return local_collections=stored?JSON.parse(stored):{certifications:[],experience:[],skills:[]},local_collections}function ValidateLocalData(){let stored;return!!localStorage.getItem("collections")}function appendData(rows){let data=rows.splice(window.globals.start,window.globals.end),finalContent="";for(let i=0;i<data.length;i++){let item=data[i],content;finalContent+=`\n              <div class="card" id="index${i}">\n                  <div class="row">\n                      <div class="col-md-3 bg-success" data-aos="fade-right" data-aos-offset="50"\n                          data-aos-duration="500">\n                          <div class="card-body cc-education-header">\n                              <div class="h5">${item.Source}</div>\n                              <p>Issued on ${item.IssuedOn}<br><em>(This certification does not expire)</em></p>\n                          </div>\n                      </div>\n                      <div class="col-md-9" data-aos="fade-left" data-aos-offset="50" data-aos-duration="500">\n                          <div class="card-body">\n                              <div class="h5">${item.Title}</div>\n                              <p class="category">${item.SubSource}</p>\n                              <p>Credential Id: ${item.CredentialId}<br>\n                                  Grade Achieved: ${item.Grade}<br>\n                                  <a href="${item.CredentialURL}"\n                                      target="_blank">Go\n                                      to Credential</a>\n                              </p>\n                          </div>\n                      </div>\n                  </div>\n              </div>\n      `}$("#cert-contents").append(finalContent),window.globals.start+=window.globals.step,rows.length%window.globals.step==0&&$("#showMore").hide()}function loadDatafromAPI(){let file_url="https://api.github.com/repos/jjnanthakumar/jjnanthakumar.github.io/contents/portfolios.xlsx";ValidateLocalData()||$.ajax({url:file_url,dataType:"jsonp",headers:{accept:"application/vnd.github.VERSION.raw",Authorization:"token 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"},success:function(results){LoadExcelJSON(results.data.content)}})}function appendExperienceDetails(rows){let finalContent="";for(let i=0;i<rows.length;i++){let item=rows[i],content;finalContent+=`\n      <div class="card">\n        <div class="row">\n          <div class="col-md-3 bg-warning" data-aos="fade-right" data-aos-offset="50"\n            data-aos-duration="500">\n            <div class="card-body cc-experience-header">\n              <p>${item.DateFrom} - ${item.DateTo} </p>\n              <div class="h5">${item.Company}</div>\n            </div>\n          </div>\n          <div class="col-md-9" data-aos="fade-left" data-aos-offset="50" data-aos-duration="500">\n            <div class="card-body">\n              <span style="float: right;"><button class="btn-tag"\n                style="border-color: ${conditionalColors[item.Status]}; background-color: ${conditionalColors[item.Status]};">${item.Status}</button></span>\n              <div class="h5">${item.Role}</div>\n              <p class="category">${item.Location}</p>\n              <p>${item.Description}</p>\n              <a href="${item.CredentialURL}" class="${item.CredentialURL?"":"disabledlink"}" target="_blank" onclick="return ${!!item.CredentialURL}">Go to\n                Credential</a>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}$("#exp-contents").append(finalContent)}function appendSkills(rows){let finalContent="";for(let i=0;i<rows.length;i++){let item=rows[i];content=`\n      <div class="col-md-6">\n        <div class="progress-container progress-primary"><span\n          class="progress-badge">${item.Category}</span>\n          <div class="progress">\n            <div class="progress-bar progress-bar-primary" data-aos="progress-full"\n              aria-progressbar-name="progressbar"\n              data-aos-offset="10" data-aos-duration="2000" role="progressbar"\n              aria-valuenow=${item.Percent} aria-valuemin="0" aria-valuemax="100"\n              style="width: ${item.Percent};"></div>\n            <span class="progress-value">${item.Percent}</span>\n          </div>\n        </div>\n      </div>\n    `,finalContent+=content}$("#skill-contents").append(finalContent)}function appendProjects(rows){let finalContent="";for(let i=0;i<rows.length;i++)item=rows[i],content=`\n      < div class="col-md-6" >\n        <div class="cc-porfolio-image img-raised" data-aos="fade-up"\n          data-aos-anchor-placement="top-bottom"><a\n            href=${item.ProjectURL} target="_blank">\n            <figure class="cc-effect"><img height="360" width="480" data-src=${item.CoverImage} class="lazyload"\n              alt="Image" />\n              <figcaption>\n                <div class="h4">${item.Title}</div>\n                <p>${item.Category}</p>\n              </figcaption>\n            </figure>\n          </a>\n        </div>\n      </div >\n      `,finalContent+=content;$("#project-contents").append(finalContent)}function clearLocalCollection(){ValidateLocalData()&&localStorage.removeItem("collections"),window.location.reload()}$(document).ready((function(){AOS.init({})})),$("a.smooth-scroll").click((function(event){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){let target=$(this.hash);target=target.length?target:$("[name="+this.hash.slice(1)+"]"),target.length&&(event.preventDefault(),$("html, body").animate({scrollTop:target.offset().top},1e3,(function(){let $target=$(target);if($target.focus(),$target.is(":focus"))return!1;$target.attr("tabindex","-1"),$target.focus()})))}})),$(document).ready((function(){loadDatafromAPI(),setTimeout(()=>{let localData=GetLocalData();appendData(localData.certifications[0]),appendExperienceDetails(localData.experience[0]),appendSkills(localData.skills[0]),appendProjects(localData.projects[0])},500),$("#showMore").on("click",(function(e){e.preventDefault(),appendData(GetLocalData().certifications[0])}))})),window.globals={page:1,step:5,start:0,end:5};